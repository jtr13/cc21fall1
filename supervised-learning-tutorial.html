<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 40 Supervised Learning Tutorial | EDAV Fall 2021 Mon/Wed Community Contributions</title>
<meta name="author" content="the students of the class">
<meta name="description" content="Sung Jun Won library(ggplot2) library(lattice) library(caret) library(AppliedPredictiveModeling) library(mlbench) library(MLmetrics) link to caret package guide:...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 40 Supervised Learning Tutorial | EDAV Fall 2021 Mon/Wed Community Contributions">
<meta property="og:type" content="book">
<meta property="og:description" content="Sung Jun Won library(ggplot2) library(lattice) library(caret) library(AppliedPredictiveModeling) library(mlbench) library(MLmetrics) link to caret package guide:...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 40 Supervised Learning Tutorial | EDAV Fall 2021 Mon/Wed Community Contributions">
<meta name="twitter:description" content="Sung Jun Won library(ggplot2) library(lattice) library(caret) library(AppliedPredictiveModeling) library(mlbench) library(MLmetrics) link to caret package guide:...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script src="libs/d3-5.16.0/d3.min.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><link href="libs/parallel-coordinates-2.1.8/parcoords.css" rel="stylesheet">
<script src="libs/parcoords-binding-1.0.0/parcoords.js"></script><script src="libs/detect-resize-0.5.3/jquery.resize.js"></script><link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet">
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script><script src="libs/vega-1.4.3/vega.min.js"></script><script src="libs/lodash-2.2.1/lodash.min.js"></script><script>var lodash = _.noConflict();</script><link href="libs/ggvis-0.4.7/css/ggvis.css" rel="stylesheet">
<script src="libs/ggvis-0.4.7/js/ggvis.js"></script><script src="libs/dendroNetwork-binding-0.4/dendroNetwork.js"></script><link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet">
<script src="libs/str_view-binding-1.4.0/str_view.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EDAV Fall 2021 Mon/Wed Community Contributions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li class="book-part">Data Visualizations</li>
<li><a class="" href="introduction-to-the-lattice-package.html"><span class="header-section-number">5</span> Introduction to the lattice package</a></li>
<li><a class="" href="graph-animation-with-gganimate-and-after-effects.html"><span class="header-section-number">6</span> Graph animation with gganimate and After Effects</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">7</span> Interactive Plots</a></li>
<li><a class="" href="create-regression-assumption-plots-in-word.html"><span class="header-section-number">8</span> Create regression assumption plots in Word</a></li>
<li><a class="" href="from-neo4j-to-rstudio.html"><span class="header-section-number">9</span> From Neo4j to RStudio</a></li>
<li class="book-part">Cheatsheets</li>
<li><a class="" href="r-vs.-python-visualization-cheatsheet.html"><span class="header-section-number">10</span> R vs. Python Visualization Cheatsheet</a></li>
<li><a class="" href="rpackage-waffle-cheatsheet.html"><span class="header-section-number">11</span> Rpackage waffle cheatsheet</a></li>
<li><a class="" href="r-cheatsheet-on-data-transforamtion-and-exploration.html"><span class="header-section-number">12</span> R cheatsheet on data transforamtion and exploration</a></li>
<li><a class="" href="r-vs-python-basic-data-wrangling.html"><span class="header-section-number">13</span> R vs Python Basic Data Wrangling</a></li>
<li><a class="" href="tidyverse_cheatsheet.html"><span class="header-section-number">14</span> tidyverse_cheatsheet</a></li>
<li><a class="" href="cheatsheet-tidyverse.html"><span class="header-section-number">15</span> Cheatsheet Tidyverse</a></li>
<li><a class="" href="use-of-ggprism-and-ggsci-packages.html"><span class="header-section-number">16</span> Use of ggprism and ggsci packages</a></li>
<li><a class="" href="interactive-plot-introduction.html"><span class="header-section-number">17</span> Interactive plot introduction</a></li>
<li><a class="" href="common-r-markdown-syntax-cheatsheet.html"><span class="header-section-number">18</span> Common R markdown syntax cheatsheet</a></li>
<li><a class="" href="header.html"><span class="header-section-number">19</span> Header</a></li>
<li><a class="" href="parallel-coordinates-plot-cheatsheet.html"><span class="header-section-number">20</span> Parallel coordinates plot cheatsheet</a></li>
<li><a class="" href="r-data-science-workflow-cheatsheet.html"><span class="header-section-number">21</span> R Data Science Workflow CheatSheet</a></li>
<li><a class="" href="a-linear-regression-bestiary.html"><span class="header-section-number">22</span> A linear regression Bestiary</a></li>
<li><a class="" href="graphql-cheat-sheet.html"><span class="header-section-number">23</span> GraphQL Cheat Sheet</a></li>
<li><a class="" href="questions-answers-for-r-technical-interview.html"><span class="header-section-number">24</span> 30 questions &amp; answers for r technical interview</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="multithreading-crawler-frame.html"><span class="header-section-number">25</span> Multithreading Crawler Frame</a></li>
<li><a class="" href="regression-and-classification-in-r.html"><span class="header-section-number">26</span> Regression and Classification in R</a></li>
<li><a class="" href="tibble-vs.-dataframe.html"><span class="header-section-number">27</span> Tibble vs. DataFrame</a></li>
<li><a class="" href="introduction-to-time-series.html"><span class="header-section-number">28</span> Introduction to Time Series</a></li>
<li><a class="" href="vipul-edav-community-contribution-kickstart-r.html"><span class="header-section-number">29</span> Vipul EDAV Community Contribution Kickstart R</a></li>
<li><a class="" href="caret---a-machine-learning-package-turotial.html"><span class="header-section-number">30</span> caret - a machine learning package turotial</a></li>
<li><a class="" href="streamlit-for-financial-analysis.html"><span class="header-section-number">31</span> Streamlit for Financial Analysis</a></li>
<li><a class="" href="interactive-graphs-tutorial.html"><span class="header-section-number">32</span> Interactive graphs tutorial</a></li>
<li><a class="" href="guideline-on-using-package-rcurl-and-xml-for-web-scraping.html"><span class="header-section-number">33</span> Guideline on Using Package Rcurl and XML for Web Scraping</a></li>
<li><a class="" href="twitter-r-package-scraping-via-api-tutorial.html"><span class="header-section-number">34</span> TwitteR R Package Scraping via API Tutorial</a></li>
<li><a class="" href="introduction-to-data-manipulation.html"><span class="header-section-number">35</span> Introduction to Data Manipulation</a></li>
<li><a class="" href="animating-the-plots-in-r.html"><span class="header-section-number">36</span> Animating the plots in R</a></li>
<li><a class="" href="quick-guide-to-eda.html"><span class="header-section-number">37</span> Quick guide to eda</a></li>
<li><a class="" href="natural-langauge-processing-common-eda-practices-in-python.html"><span class="header-section-number">38</span> Natural Langauge Processing Common EDA Practices in Python</a></li>
<li><a class="" href="beginners-walk-through-of-deep-learning-in-r.html"><span class="header-section-number">39</span> Beginner’s Walk-through of Deep Learning in R</a></li>
<li><a class="active" href="supervised-learning-tutorial.html"><span class="header-section-number">40</span> Supervised Learning Tutorial</a></li>
<li><a class="" href="parallel-coordinate-plots-in-ggplot2.html"><span class="header-section-number">41</span> Parallel Coordinate Plots in ggplot2</a></li>
<li><a class="" href="using-ggplot-in-python.html"><span class="header-section-number">42</span> Using ggplot in python</a></li>
<li><a class="" href="icons-and-symbols-in-r.html"><span class="header-section-number">43</span> Icons and symbols in R</a></li>
<li><a class="" href="exploratory-data-analysis-and-preprocessing-with-r-for-data-challenges.html"><span class="header-section-number">44</span> Exploratory data analysis and preprocessing with R for data challenges</a></li>
<li class="book-part">Demonstrations</li>
<li><a class="" href="linear-association-r-studio-plugin.html"><span class="header-section-number">45</span> Linear Association R Studio Plugin</a></li>
<li><a class="" href="customized-sorting-in-r.html"><span class="header-section-number">46</span> Customized Sorting in R</a></li>
<li class="book-part">Workshops</li>
<li><a class="" href="data-science-product-cycles-in-enterprises.html"><span class="header-section-number">47</span> Data Science Product Cycles in Enterprises</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">48</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">49</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cc21fall1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="supervised-learning-tutorial" class="section level1">
<h1>
<span class="header-section-number">40</span> Supervised Learning Tutorial<a class="anchor" aria-label="anchor" href="#supervised-learning-tutorial"><i class="fas fa-link"></i></a>
</h1>
<p>Sung Jun Won</p>
<div class="sourceCode" id="cb572"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://appliedpredictivemodeling.com/">AppliedPredictiveModeling</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/yanyachen/MLmetrics">MLmetrics</a></span><span class="op">)</span></code></pre></div>
<p>link to caret package guide:
<a href="http://topepo.github.io/caret/index.html" class="uri">http://topepo.github.io/caret/index.html</a></p>
<p>In this tutorial, I will be introducing caret, R package that supports various machine learning tools. I will mainly focus on introducing supervised learning.</p>
<p>There are few important steps in supervised learning.
1. Data preprocessing
2. Data splitting
3. Model selection
4. Training
5. Evaluation</p>
<p>Let’s walk through these steps one by one.</p>
<ol style="list-style-type: decimal">
<li>Data preprocessing</li>
</ol>
<p>To go through the data preprocessing step, we will be using schedulingData data from AppliedPredictiveModeling library.</p>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">schedulingData</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">schedulingData</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    4331 obs. of  8 variables:
##  $ Protocol   : Factor w/ 14 levels "A","C","D","E",..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ Compounds  : num  997 97 101 93 100 100 105 98 101 95 ...
##  $ InputFields: num  137 103 75 76 82 82 88 95 91 92 ...
##  $ Iterations : num  20 20 10 20 20 20 20 20 20 20 ...
##  $ NumPending : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ Hour       : num  14 13.8 13.8 10.1 10.4 ...
##  $ Day        : Factor w/ 7 levels "Mon","Tue","Wed",..: 2 2 4 5 5 3 5 5 5 3 ...
##  $ Class      : Factor w/ 4 levels "VF","F","M","L": 2 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>Some dataset may have features that have only one unique value, or some unique values that occur with very low frequency. Model trained on such dataset may crash or not fit well.
To resolve this issue, we can use nearZeroVar to identify such features and remove such features.</p>
<div class="sourceCode" id="cb575"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nzv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/nearZeroVar.html">nearZeroVar</a></span><span class="op">(</span><span class="va">schedulingData</span><span class="op">)</span>
<span class="va">filteredDescr</span> <span class="op">&lt;-</span> <span class="va">schedulingData</span><span class="op">[</span>, <span class="op">-</span><span class="va">nzv</span><span class="op">]</span>
<span class="va">filteredDescr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></code></pre></div>
<pre><code>##    Protocol Compounds InputFields Iterations     Hour Day Class
## 1         E       997         137         20 14.00000 Tue     F
## 2         E        97         103         20 13.81667 Tue    VF
## 3         E       101          75         10 13.85000 Thu    VF
## 4         E        93          76         20 10.10000 Fri    VF
## 5         E       100          82         20 10.36667 Fri    VF
## 6         E       100          82         20 16.53333 Wed    VF
## 7         E       105          88         20 16.40000 Fri    VF
## 8         E        98          95         20 16.73333 Fri    VF
## 9         E       101          91         20 16.18333 Fri    VF
## 10        E        95          92         20 10.78333 Wed    VF</code></pre>
<p>For models that can’t take categorical features (linear regression, logistic regression, etc), we need to convert them to dummy variables using so-called One-Hot Encoding.</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">filteredDescr</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    4331 obs. of  7 variables:
##  $ Protocol   : Factor w/ 14 levels "A","C","D","E",..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ Compounds  : num  997 97 101 93 100 100 105 98 101 95 ...
##  $ InputFields: num  137 103 75 76 82 82 88 95 91 92 ...
##  $ Iterations : num  20 20 10 20 20 20 20 20 20 20 ...
##  $ Hour       : num  14 13.8 13.8 10.1 10.4 ...
##  $ Day        : Factor w/ 7 levels "Mon","Tue","Wed",..: 2 2 4 5 5 3 5 5 5 3 ...
##  $ Class      : Factor w/ 4 levels "VF","F","M","L": 2 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb579"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dummies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/dummyVars.html">dummyVars</a></span><span class="op">(</span><span class="st">"~."</span>, data <span class="op">=</span> <span class="va">filteredDescr</span><span class="op">[</span>,<span class="op">-</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>
<span class="va">encodedData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/predict.html">predict</a></span><span class="op">(</span><span class="va">dummies</span>, newdata <span class="op">=</span> <span class="va">filteredDescr</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">encodedData</span><span class="op">)</span></code></pre></div>
<pre><code>##   Protocol.A Protocol.C Protocol.D Protocol.E Protocol.F Protocol.G Protocol.H
## 1          0          0          0          1          0          0          0
## 2          0          0          0          1          0          0          0
## 3          0          0          0          1          0          0          0
## 4          0          0          0          1          0          0          0
## 5          0          0          0          1          0          0          0
## 6          0          0          0          1          0          0          0
##   Protocol.I Protocol.J Protocol.K Protocol.L Protocol.M Protocol.N Protocol.O
## 1          0          0          0          0          0          0          0
## 2          0          0          0          0          0          0          0
## 3          0          0          0          0          0          0          0
## 4          0          0          0          0          0          0          0
## 5          0          0          0          0          0          0          0
## 6          0          0          0          0          0          0          0
##   Compounds InputFields Iterations     Hour Day.Mon Day.Tue Day.Wed Day.Thu
## 1       997         137         20 14.00000       0       1       0       0
## 2        97         103         20 13.81667       0       1       0       0
## 3       101          75         10 13.85000       0       0       0       1
## 4        93          76         20 10.10000       0       0       0       0
## 5       100          82         20 10.36667       0       0       0       0
## 6       100          82         20 16.53333       0       0       1       0
##   Day.Fri Day.Sat Day.Sun
## 1       0       0       0
## 2       0       0       0
## 3       0       0       0
## 4       1       0       0
## 5       1       0       0
## 6       0       0       0</code></pre>
<p>We can see that for each categorical values, a column is made with values of 0 and 1.</p>
<p>To preprocess all the features as needed, caret supports an amazing function called preProcess, which decides whatever preprocessings it needs to perform on any dataset and apply them accordingly.
For numerical features, we can apply centering and scaling to normalize the dataset.</p>
<div class="sourceCode" id="cb581"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pp_hpc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/preProcess.html">preProcess</a></span><span class="op">(</span><span class="va">encodedData</span>, 
                     method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"scale"</span>, <span class="st">"YeoJohnson"</span><span class="op">)</span><span class="op">)</span>
<span class="va">transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/predict.html">predict</a></span><span class="op">(</span><span class="va">pp_hpc</span>, newdata <span class="op">=</span> <span class="va">encodedData</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">transformed</span><span class="op">)</span></code></pre></div>
<pre><code>##   Protocol.A Protocol.C Protocol.D Protocol.E Protocol.F Protocol.G Protocol.H
## 1 -0.1489308 -0.1958347 -0.1887344   6.641114 -0.2021043 -0.1926351 -0.2828982
## 2 -0.1489308 -0.1958347 -0.1887344   6.641114 -0.2021043 -0.1926351 -0.2828982
## 3 -0.1489308 -0.1958347 -0.1887344   6.641114 -0.2021043 -0.1926351 -0.2828982
## 4 -0.1489308 -0.1958347 -0.1887344   6.641114 -0.2021043 -0.1926351 -0.2828982
## 5 -0.1489308 -0.1958347 -0.1887344   6.641114 -0.2021043 -0.1926351 -0.2828982
## 6 -0.1489308 -0.1958347 -0.1887344   6.641114 -0.2021043 -0.1926351 -0.2828982
##   Protocol.I Protocol.J  Protocol.K Protocol.L Protocol.M Protocol.N Protocol.O
## 1 -0.3105373 -0.5439322 -0.03724195 -0.2432478 -0.3408963 -0.3757737 -0.3935703
## 2 -0.3105373 -0.5439322 -0.03724195 -0.2432478 -0.3408963 -0.3757737 -0.3935703
## 3 -0.3105373 -0.5439322 -0.03724195 -0.2432478 -0.3408963 -0.3757737 -0.3935703
## 4 -0.3105373 -0.5439322 -0.03724195 -0.2432478 -0.3408963 -0.3757737 -0.3935703
## 5 -0.3105373 -0.5439322 -0.03724195 -0.2432478 -0.3408963 -0.3757737 -0.3935703
## 6 -0.3105373 -0.5439322 -0.03724195 -0.2432478 -0.3408963 -0.3757737 -0.3935703
##    Compounds InputFields Iterations         Hour    Day.Mon   Day.Tue
## 1  1.2289592  -0.6324580 -0.0615593  0.004586516 -0.4360255  1.952266
## 2 -0.6065826  -0.8120473 -0.0615593 -0.043733201 -0.4360255  1.952266
## 3 -0.5719534  -1.0131504 -2.7894869 -0.034967177 -0.4360255 -0.512107
## 4 -0.6427737  -1.0047277 -0.0615593 -0.964170752 -0.4360255 -0.512107
## 5 -0.5804713  -0.9564504 -0.0615593 -0.902085020 -0.4360255 -0.512107
## 6 -0.5804713  -0.9564504 -0.0615593  0.698108782 -0.4360255 -0.512107
##      Day.Wed    Day.Thu    Day.Fri     Day.Sat    Day.Sun
## 1 -0.5131843 -0.4464804 -0.5203564 -0.08626629 -0.1964693
## 2 -0.5131843 -0.4464804 -0.5203564 -0.08626629 -0.1964693
## 3 -0.5131843  2.2392230 -0.5203564 -0.08626629 -0.1964693
## 4 -0.5131843 -0.4464804  1.9213160 -0.08626629 -0.1964693
## 5 -0.5131843 -0.4464804  1.9213160 -0.08626629 -0.1964693
## 6  1.9481679 -0.4464804 -0.5203564 -0.08626629 -0.1964693</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Data Splitting</li>
</ol>
<p>We can split the data into train &amp; test.
We can use createDataPartition function to create balanced split between train and test.
We will use Sonar data from mlbench package as an example.</p>
<div class="sourceCode" id="cb583"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    208 obs. of  61 variables:
##  $ V1   : num  0.02 0.0453 0.0262 0.01 0.0762 0.0286 0.0317 0.0519 0.0223 0.0164 ...
##  $ V2   : num  0.0371 0.0523 0.0582 0.0171 0.0666 0.0453 0.0956 0.0548 0.0375 0.0173 ...
##  $ V3   : num  0.0428 0.0843 0.1099 0.0623 0.0481 ...
##  $ V4   : num  0.0207 0.0689 0.1083 0.0205 0.0394 ...
##  $ V5   : num  0.0954 0.1183 0.0974 0.0205 0.059 ...
##  $ V6   : num  0.0986 0.2583 0.228 0.0368 0.0649 ...
##  $ V7   : num  0.154 0.216 0.243 0.11 0.121 ...
##  $ V8   : num  0.16 0.348 0.377 0.128 0.247 ...
##  $ V9   : num  0.3109 0.3337 0.5598 0.0598 0.3564 ...
##  $ V10  : num  0.211 0.287 0.619 0.126 0.446 ...
##  $ V11  : num  0.1609 0.4918 0.6333 0.0881 0.4152 ...
##  $ V12  : num  0.158 0.655 0.706 0.199 0.395 ...
##  $ V13  : num  0.2238 0.6919 0.5544 0.0184 0.4256 ...
##  $ V14  : num  0.0645 0.7797 0.532 0.2261 0.4135 ...
##  $ V15  : num  0.066 0.746 0.648 0.173 0.453 ...
##  $ V16  : num  0.227 0.944 0.693 0.213 0.533 ...
##  $ V17  : num  0.31 1 0.6759 0.0693 0.7306 ...
##  $ V18  : num  0.3 0.887 0.755 0.228 0.619 ...
##  $ V19  : num  0.508 0.802 0.893 0.406 0.203 ...
##  $ V20  : num  0.48 0.782 0.862 0.397 0.464 ...
##  $ V21  : num  0.578 0.521 0.797 0.274 0.415 ...
##  $ V22  : num  0.507 0.405 0.674 0.369 0.429 ...
##  $ V23  : num  0.433 0.396 0.429 0.556 0.573 ...
##  $ V24  : num  0.555 0.391 0.365 0.485 0.54 ...
##  $ V25  : num  0.671 0.325 0.533 0.314 0.316 ...
##  $ V26  : num  0.641 0.32 0.241 0.533 0.229 ...
##  $ V27  : num  0.71 0.327 0.507 0.526 0.7 ...
##  $ V28  : num  0.808 0.277 0.853 0.252 1 ...
##  $ V29  : num  0.679 0.442 0.604 0.209 0.726 ...
##  $ V30  : num  0.386 0.203 0.851 0.356 0.472 ...
##  $ V31  : num  0.131 0.379 0.851 0.626 0.51 ...
##  $ V32  : num  0.26 0.295 0.504 0.734 0.546 ...
##  $ V33  : num  0.512 0.198 0.186 0.612 0.288 ...
##  $ V34  : num  0.7547 0.2341 0.2709 0.3497 0.0981 ...
##  $ V35  : num  0.854 0.131 0.423 0.395 0.195 ...
##  $ V36  : num  0.851 0.418 0.304 0.301 0.418 ...
##  $ V37  : num  0.669 0.384 0.612 0.541 0.46 ...
##  $ V38  : num  0.61 0.106 0.676 0.881 0.322 ...
##  $ V39  : num  0.494 0.184 0.537 0.986 0.283 ...
##  $ V40  : num  0.274 0.197 0.472 0.917 0.243 ...
##  $ V41  : num  0.051 0.167 0.465 0.612 0.198 ...
##  $ V42  : num  0.2834 0.0583 0.2587 0.5006 0.2444 ...
##  $ V43  : num  0.282 0.14 0.213 0.321 0.185 ...
##  $ V44  : num  0.4256 0.1628 0.2222 0.3202 0.0841 ...
##  $ V45  : num  0.2641 0.0621 0.2111 0.4295 0.0692 ...
##  $ V46  : num  0.1386 0.0203 0.0176 0.3654 0.0528 ...
##  $ V47  : num  0.1051 0.053 0.1348 0.2655 0.0357 ...
##  $ V48  : num  0.1343 0.0742 0.0744 0.1576 0.0085 ...
##  $ V49  : num  0.0383 0.0409 0.013 0.0681 0.023 0.0264 0.0507 0.0285 0.0777 0.0092 ...
##  $ V50  : num  0.0324 0.0061 0.0106 0.0294 0.0046 0.0081 0.0159 0.0178 0.0439 0.0198 ...
##  $ V51  : num  0.0232 0.0125 0.0033 0.0241 0.0156 0.0104 0.0195 0.0052 0.0061 0.0118 ...
##  $ V52  : num  0.0027 0.0084 0.0232 0.0121 0.0031 0.0045 0.0201 0.0081 0.0145 0.009 ...
##  $ V53  : num  0.0065 0.0089 0.0166 0.0036 0.0054 0.0014 0.0248 0.012 0.0128 0.0223 ...
##  $ V54  : num  0.0159 0.0048 0.0095 0.015 0.0105 0.0038 0.0131 0.0045 0.0145 0.0179 ...
##  $ V55  : num  0.0072 0.0094 0.018 0.0085 0.011 0.0013 0.007 0.0121 0.0058 0.0084 ...
##  $ V56  : num  0.0167 0.0191 0.0244 0.0073 0.0015 0.0089 0.0138 0.0097 0.0049 0.0068 ...
##  $ V57  : num  0.018 0.014 0.0316 0.005 0.0072 0.0057 0.0092 0.0085 0.0065 0.0032 ...
##  $ V58  : num  0.0084 0.0049 0.0164 0.0044 0.0048 0.0027 0.0143 0.0047 0.0093 0.0035 ...
##  $ V59  : num  0.009 0.0052 0.0095 0.004 0.0107 0.0051 0.0036 0.0048 0.0059 0.0056 ...
##  $ V60  : num  0.0032 0.0044 0.0078 0.0117 0.0094 0.0062 0.0103 0.0053 0.0022 0.004 ...
##  $ Class: Factor w/ 2 levels "M","R": 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<p>By setting p = 0.8, we can split the data in 8:2 ratio, 8 for train and 2 for test.
We want matrix output so list = FALSE, and since we are only splitting into two, partition times = 1.</p>
<div class="sourceCode" id="cb585"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inTraining</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html">createDataPartition</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">$</span><span class="va">Class</span>, p <span class="op">=</span> <span class="fl">.8</span>, list <span class="op">=</span> <span class="cn">FALSE</span>, times <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">training</span> <span class="op">&lt;-</span> <span class="va">Sonar</span><span class="op">[</span> <span class="va">inTraining</span>,<span class="op">]</span>
<span class="va">testing</span>  <span class="op">&lt;-</span> <span class="va">Sonar</span><span class="op">[</span><span class="op">-</span><span class="va">inTraining</span>,<span class="op">]</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Model Selection</li>
</ol>
<p>caret provides trainControl function, with which we can change the cross validation methods, parameters for tuning, number of folds for k-fold CV, number of resampling, etc. Depending on what classification or regression model we decide to use, we can set these parameters as fit and tune the model to be optimal.</p>
<p>For instance, if we want to use k-fold cross validation, with the number of folds = 10 and number of resampling = 10, we can set the parameters as such:</p>
<div class="sourceCode" id="cb586"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span><span class="co">## 10-fold CV</span>
                           method <span class="op">=</span> <span class="st">"repeatedcv"</span>,
                           number <span class="op">=</span> <span class="fl">10</span>,
                           <span class="co">## repeated ten times</span>
                           repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>In python, we have to do hyperparameter tuning to find the best performing model. But in R, the function train by default uses best, which basically means that it chooses the parameters that shows the best accuracy. (or lowest RMSE)</p>
<p>==&gt; best(testing, “RMSE”, maximize = FALSE)</p>
<p>But there are two other choices besides best, which are oneSE and tolerance.</p>
<p>oneSE aims to find the simplest model within one standard error of ideally most optimal model.</p>
<p>==&gt; oneSE(testing, “RMSE”, maximize = FALSE, num = 10)</p>
<p>tolerance attempts to find less complex model that falls within a percent tolerance from ideally most optimal model.</p>
<p>==&gt; tolerance(testing, “RMSE”, tol = 3, maximize = FALSE)</p>
<p>The idea behind using oneSE and tolerance is that they are ordering of models from simple to complex, but in many cases, models are too complicated to order one next to another. It is important to use the these two methods if the ordering of model complexity is deemed right.</p>
<ol start="4" style="list-style-type: decimal">
<li>Training</li>
</ol>
<p>We can use the cross validation parameters chosen to train the model.
There are numerous classification or regression models that we can use to fit the data.</p>
<p>To list a few, there are
“treebag” or “logicbag” for Bagged Trees,
“rf” for Random Forest,
“adaboost” or “gbm” for Boosted Trees,
“lm” for Linear Regression,
“logreg” for Logistic Regression,
and of course, numerous variations to these models too with regularization and so on.</p>
<p>To show an example, we can see Random Forest model fitting to the training data, with the 10-fold cross validation choosing the model with best performance.</p>
<div class="sourceCode" id="cb587"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rfFit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">training</span>,
                 method <span class="op">=</span> <span class="st">"rf"</span>, 
                 trControl <span class="op">=</span> <span class="va">fitControl</span><span class="op">)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Evaluation</li>
</ol>
<p>Using postResample function, we can get the performance of the model on the test data. With Random Forest, we can get prediction accuracy and Kappa, which compares observed accuracy from expected accuracy.</p>
<div class="sourceCode" id="cb588"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/predict.html">predict</a></span><span class="op">(</span><span class="va">rfFit</span>, <span class="va">testing</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/caret/man/postResample.html">postResample</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="va">pred</span>, obs <span class="op">=</span> <span class="va">testing</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span></code></pre></div>
<pre><code>##  Accuracy     Kappa 
## 0.8780488 0.7521161</code></pre>
<p>We can also get confusion matrix for the test data using confusionMatrix function. It shows the accuracy scores as well as p-value and other evaluation metrics. To get precision, recall, and F1 score, we can set mode to “prec_recall”.</p>
<div class="sourceCode" id="cb590"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pred</span>, reference <span class="op">=</span> <span class="va">testing</span><span class="op">$</span><span class="va">Class</span>, mode <span class="op">=</span> <span class="st">"prec_recall"</span><span class="op">)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  M  R
##          M 21  4
##          R  1 15
##                                          
##                Accuracy : 0.878          
##                  95% CI : (0.738, 0.9592)
##     No Information Rate : 0.5366         
##     P-Value [Acc &gt; NIR] : 3.487e-06      
##                                          
##                   Kappa : 0.7521         
##                                          
##  Mcnemar's Test P-Value : 0.3711         
##                                          
##               Precision : 0.8400         
##                  Recall : 0.9545         
##                      F1 : 0.8936         
##              Prevalence : 0.5366         
##          Detection Rate : 0.5122         
##    Detection Prevalence : 0.6098         
##       Balanced Accuracy : 0.8720         
##                                          
##        'Positive' Class : M              
## </code></pre>
<p>So far, we have seen the basics of supervised learning.
In the link provided above, there are more details of each step as well as other steps to consider such as feature selection, calibration, etc.</p>
<p>I hope you guys liked this tutorial!</p>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="beginners-walk-through-of-deep-learning-in-r.html"><span class="header-section-number">39</span> Beginner’s Walk-through of Deep Learning in R</a></div>
<div class="next"><a href="parallel-coordinate-plots-in-ggplot2.html"><span class="header-section-number">41</span> Parallel Coordinate Plots in ggplot2</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#supervised-learning-tutorial"><span class="header-section-number">40</span> Supervised Learning Tutorial</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cc21fall1/blob/main/supervised_learning_tutorial.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cc21fall1/edit/main/supervised_learning_tutorial.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EDAV Fall 2021 Mon/Wed Community Contributions</strong>" was written by the students of the class. It was last built on 2021-11-09.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
